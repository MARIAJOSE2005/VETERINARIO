{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Agendar Cita</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #e0f7fa, #ffffff);
            background-image: url('{% static "clinica/img/agendar_citas.jpg" %}');
            background-size: cover;          /* cubre toda la pantalla */
            background-position: center;     /* centra la imagen */
            background-attachment: fixed;    /* efecto parallax */
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .card {
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.75); /* blanco semitransparente */
            backdrop-filter: blur(10px);           /* difumina la imagen detr√°s */
            -webkit-backdrop-filter: blur(10px);   /* soporte Safari */
        }
        .btn-lg {
            border-radius: 30px;
            font-weight: bold;
        }
    </style>

</head>
<body>
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-lg">
                <div class="card-header bg-primary text-white text-center">
                    <h2>Agendar una Cita üê∂üê±</h2>
                </div>
                <div class="card-body">
                    {% if messages %}
                        <div class="alert alert-danger">
                            {% for message in messages %}
                                {{ message }}
                            {% endfor %}
                        </div>
                    {% endif %}

                    <form method="post">
                        {% csrf_token %}

                        <!-- Datos del Due√±o -->
                        <h5>Datos del Due√±o</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">C√©dula del due√±o</label>
                                <input type="text" name="cedula" class="form-control" placeholder="Ej: 1100123456" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Nombre del due√±o</label>
                                <input type="text" name="nombre_dueno" class="form-control" placeholder="Ej: Mar√≠a" required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Apellido del due√±o</label>
                                <input type="text" name="apellido_dueno" class="form-control" placeholder="Ej: Garc√≠a" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Tel√©fono</label>
                                <input type="text" name="telefono" class="form-control" placeholder="Ej: 0991234567" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Correo</label>
                            <input type="email" name="correo" class="form-control" placeholder="Ej: maria@email.com" required>
                        </div>

                        <!-- Datos de la Mascota -->
                        <h5>Datos de la Mascota</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Nombre de la mascota</label>
                                <input type="text" name="nombre_mascota" class="form-control" placeholder="Ej: Firulais" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Especie</label>
                                <select name="especie" class="form-select" required>
                                    <option value="">Seleccione especie</option>
                                    <option value="Perro">Perro</option>
                                    <option value="Gato">Gato</option>
                                    <option value="Ave">Ave</option>
                                    <option value="Conejo">Conejo</option>
                                    <option value="Otro">Otro</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Edad</label>
                            <input type="number" name="edad" class="form-control" placeholder="Ej: 3" required>
                        </div>

                        <!-- Datos de la Cita -->
                        <h5>Datos de la Cita</h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Fecha</label>
                                <input type="date" name="fecha" class="form-control" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Hora</label>
                                <input type="time" name="hora" class="form-control" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Especialidad</label>
                            <select id="especialidad" name="especialidad" class="form-select" required>
                                <option value="">Seleccione especialidad</option>
                                <option value="General">General</option>
                                <option value="Cirug√≠a">Cirug√≠a</option>
                                <option value="Dermatolog√≠a">Dermatolog√≠a</option>
                            </select>
                        </div>

                        <!-- Veterinario din√°mico -->
                        <div class="mb-3">
                            <label class="form-label">Veterinario</label>
                            <select id="veterinario" name="veterinario" class="form-select" required>
                                <option value="">Seleccione veterinario</option>
                                {% for vet in veterinarios %}
                                <option value="{{ vet.id }}">{{ vet.nombre }} - {{ vet.especialidad }}</option>
                                {% endfor %}


                            </select>
                        </div>

                        <div class="d-grid gap-2 mt-4">
                            <button type="submit" class="btn btn-primary btn-lg">Confirmar Cita</button>
                            <a href="{% url 'bienvenida' %}" class="btn btn-outline-secondary btn-lg">Volver</a>
                        </div>
                    </form>
                </div>
            </div>
            <p class="text-center text-muted mt-3">Gracias por confiar en nosotros üêæ</p>
        </div>
    </div>
</div>

<!-- Script para cargar veterinarios din√°micamente -->
<script>
document.getElementById('especialidad').addEventListener('change', function() {
    let especialidad = this.value;
    if (especialidad) {
        fetch(`/get_veterinarios/?especialidad=${especialidad}`)
            .then(response => response.json())
            .then(data => {
                let vetSelect = document.getElementById('veterinario');
                vetSelect.innerHTML = '<option value="">Seleccione veterinario</option>';
                data.forEach(vet => {
                    vetSelect.innerHTML += `<option value="${vet.id}">${vet.nombre}</option>`;
                });
            });
    }
});
</script>
</body>
</html>